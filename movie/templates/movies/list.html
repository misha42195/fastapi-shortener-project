{% extends 'base.html' %}
{% block title %}
  Movie list
{% endblock %}
{% block main %}
  <h1>
    All movie list
  </h1>
  {% if movies_list %}
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead>
        <tr>
          <th scope="col">Slug</th>
          <th scope="col">Title</th>
          <th scope="col">Director</th>
          <th scope="col">Release year</th>
          <th scope="col">Description</th>
          <th scope="col">Acton</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          {% for movies in movies_list %}
            <td><code>{{ movies.slug }}</code></td>
            <td>{{ movies.title }}</td>
            <td>{{ movies.director }}</td>
            <td>{{ movies.release_year }}</td>
            <td>{% if movies.description %}
              {{ movies.description }}
            {% else %}
              <code>---</code>
            {% endif %} </td>
            <td>
              <div class="btn-group"
                   role="group"
                   aria-label="Movies"
              >
                <a class="btn btn-outline-info"
                   href="{{ url_for('movie:update-views',slug=movies.slug) }}">Edit</a>
                <!-- Button trigger modal -->
                <button
                  type="button"
                  class="btn btn-outline-danger"
                  data-bs-toggle="modal"
                  data-bs-target="#modal-confirm-delete{{ movies.slug }}-label">
                  Delete
                </button>
              </div>
              <!-- Modal -->
              <div class="modal fade"
                   id="modal-confirm-delete{{ movies.slug }}-label"
                   tabindex="-1"
                   aria-labelledby="modal-confirm-delete{{ movies.slug }}-label"
                   aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5"
                          id="modal-confirm-delete{{ movies.slug }}-label"
                      >Confirm delete movie<code>{{ movies.slug }}</code></h1>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      Are you sure delete <code>{{ movies.slug }}</code>
                    </div>
                    <div class="modal-footer">
                      <button
                        type="button"
                        class="btn btn-secondary"
                        data-bs-dismiss="modal">Close
                      </button>
                      <button
                        hx-delete="{{ url_for('delete:movie',slug=movies.slug) }}"
                        hx-target="closest tr"
                        hx-swap="outerHTML swap:0.5s"
                        type="submit"
                        class="btn btn-danger"
                        data-bs-dismiss="modal"
                      >Permanently delete
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </td>
            </tr>
          {% endfor %}
      </table>
    </div>
    <div class="mt-3">
      <a
        href="{{ url_for('movies:create-view') }}"
        class="btn btn-outline-primary">Crete movie
      </a>
    </div>
  {% else %}
    <p>Not movie yet</p>
    <h3>
      <a
        href="{{ url_for('movies:create-view') }}"> Create a new movie
      </a>
    </h3>
  {% endif %}
  <style>
      tr.htmx-swapping td {
          opacity: 0;
          transition: opacity 0.5s ease-out;
      }
  </style>
  <script
    src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
    integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz"
    crossorigin="anonymous">
  </script>
{% endblock %}
